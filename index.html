<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SKIN CASE - Estuches Personalizados 3D</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;600;800&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Poppins', sans-serif; 
            background: #F5F5F7; 
            color: #333; 
            overflow-x: hidden; 
            transition: all 0.5s ease;
            position: relative;
        }
        :root {
            --accent: #00CED1;
            --btn: #8B00FF;
            --hover: #9932CC;
            --card-bg: #FFFFFF;
            --border: #E8E8E8;
            --text: #333;
            --bg: #F5F5F7;
        }
        .dark-mode {
            --bg: #1a1a1a;
            --card-bg: #2d2d2d;
            --text: #f0f0f0;
            --border: #444;
            background: #1a1a1a !important;
            color: #f0f0f0 !important;
        }
        .dark-mode .card, .dark-mode .modal-content, .dark-mode .customization-options, .dark-mode .phone-preview,
        .dark-mode .brand-card, .dark-mode .model-card, .dark-mode .skin-type, .dark-mode .border-btn,
        .dark-mode .action-btn, .dark-mode .upload-btn, .dark-mode .add-to-cart, .dark-mode .add-another,
        .dark-mode .cart-modal, .dark-mode .design-canvas, .dark-mode .text-input, .dark-mode .emoji-item,
        .dark-mode .phone-frame, .dark-mode .phone-screen {
            background: #2d2d2d !important;
            color: #f0f0f0 !important;
            border-color: #444 !important;
        }

        /* PARTÍCULAS DE FONDO */
        #particles { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none; }
        .particle {
            position: absolute; width: 8px; height: 8px; background: var(--accent); border-radius: 50%;
            opacity: 0.6; animation: float 6s infinite ease-in-out; pointer-events: none;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        /* HEADER */
        header {
            background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); padding: 15px 20px;
            position: fixed; top: 0; left: 0; right: 0; z-index: 1000; box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            animation: slideDown 0.6s ease-out;
        }
        @keyframes slideDown {
            from { transform: translateY(-100%); }
            to { transform: translateY(0); }
        }
        .logo-img { height: 45px; filter: drop-shadow(0 0 8px rgba(139, 0, 255, 0.3)); animation: pulse 2s infinite; }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* BIENVENIDA */
        .welcome-screen {
            min-height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center;
            text-align: center; padding: 120px 20px 60px; opacity: 0; animation: fadeInUp 1s forwards 0.3s;
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .typewriter {
            font-size: 1.6rem; color: var(--accent); overflow: hidden; white-space: nowrap; border-right: 3px solid var(--btn);
            width: 0; animation: typing 3s steps(30) forwards, blink 0.7s infinite;
            margin: 20px auto; max-width: 700px;
        }
        @keyframes typing {
            from { width: 0; }
            to { width: 100%; }
        }
        @keyframes blink {
            50% { border-color: transparent; }
        }

        .btn {
            background: linear-gradient(135deg, var(--btn), var(--accent)); color: #FFF; border: none;
            padding: 18px 55px; font-size: 1.4rem; font-weight: 700; border-radius: 50px; cursor: pointer;
            transition: all 0.4s ease; box-shadow: 0 8px 25px rgba(139, 0, 255, 0.3); text-transform: uppercase;
            position: relative; overflow: hidden; animation: bounceIn 1s ease 1.5s both;
        }
        .btn::before {
            content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: 0.5s;
        }
        .btn:hover::before { left: 100%; }
        .btn:hover { transform: translateY(-5px) scale(1.05); box-shadow: 0 15px 35px rgba(139, 0, 255, 0.5); }
        @keyframes bounceIn {
            0% { opacity: 0; transform: scale(0.3); }
            50% { opacity: 1; transform: scale(1.1); }
            70% { transform: scale(0.9); }
            100% { transform: scale(1); }
        }

        /* SELECCIÓN */
        .selection-screen { display: none; min-height: 100vh; padding: 120px 20px 20px; position: relative; }
        .back-btn { position: absolute; top: 100px; left: 20px; background: var(--accent); color: #FFF; border: none; width: 50px; height: 50px; border-radius: 50%; font-size: 1.2rem; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s; box-shadow: 0 4px 15px rgba(0, 206, 209, 0.3); }
        .back-btn:hover { background: var(--btn); transform: translateX(-5px) scale(1.1); }

        .brands-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 20px; margin-bottom: 40px; }
        .brand-card { background: var(--card-bg); border: 1px solid var(--border); border-radius: 18px; padding: 25px; text-align: center; cursor: pointer; transition: all 0.4s ease; box-shadow: 0 6px 15px rgba(0,0,0,0.1); }
        .brand-card:hover { transform: translateY(-12px) rotateX(5deg) rotateY(5deg); border-color: var(--accent); box-shadow: 0 20px 40px rgba(0, 206, 209, 0.3); }
        .brand-logo { font-size: 2.8rem; margin-bottom: 15px; color: var(--accent); }
        .brand-name { font-size: 1.1rem; font-weight: 600; color: var(--text); }

        .models-container { display: none; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; }
        .model-card { background: var(--card-bg); border: 1px solid var(--border); border-radius: 15px; padding: 20px; text-align: center; cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .model-card:hover { transform: translateY(-5px); border-color: var(--btn); box-shadow: 0 10px 25px rgba(139, 0, 255, 0.15); }
        .model-name { font-size: 1.1rem; font-weight: 600; color: var(--text); }

        /* PERSONALIZACIÓN */
        .customization-screen { display: none; min-height: 100vh; padding: 120px 20px 20px; position: relative; }
        .customization-container { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; }
        .phone-preview { background: var(--card-bg); border-radius: 20px; padding: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); display: flex; flex-direction: column; align-items: center; }
        .phone-frame { width: 300px; height: 600px; background: var(--bg); border-radius: 40px; position: relative; overflow: hidden; box-shadow: 0 20px 50px rgba(0,0,0,0.2); margin-bottom: 25px; }
        .phone-screen { width: 270px; height: 570px; background: var(--card-bg); border-radius: 30px; position: absolute; top: 15px; left: 15px; overflow: hidden; }
        .phone-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 10; }
        .back-cameras { position: absolute; top: 30px; left: 50%; transform: translateX(-50%); }

        .custom-image-container { width: 100%; height: 100%; position: relative; overflow: hidden; border: 2px solid transparent; transition: border 0.3s; }
        .custom-element { position: absolute; user-select: none; cursor: move; z-index: 5; }
        .custom-image { max-width: 100%; max-height: 100%; }
        .custom-text { padding: 8px 12px; background: rgba(255,255,255,0.9); border-radius: 6px; font-weight: 600; }
        .custom-emoji { font-size: 2.5rem; }

        .transform-controls { display: flex; gap: 12px; margin: 15px 0; }
        .transform-btn { width: 42px; height: 42px; border-radius: 50%; background: var(--card-bg); border: 1px solid var(--border); color: var(--text); display: flex; align-items: center; justify-content: center; cursor: pointer; transition: 0.3s; }
        .transform-btn:hover { background: var(--accent); color: #333; border-color: var(--accent); }

        .customization-options { background: var(--card-bg); border-radius: 20px; padding: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .option-title { font-size: 1.6rem; margin-bottom: 20px; color: var(--btn); }
        .skin-types { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 30px; }
        .skin-type { background: #F8F8F8; border: 2px solid var(--border); border-radius: 12px; padding: 16px; text-align: center; cursor: pointer; transition: 0.3s; color: var(--text); }
        .skin-type.active, .skin-type:hover { border-color: var(--accent); background: rgba(0, 206, 209, 0.1); }

        .border-options { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px; }
        .border-btn { padding: 10px; background: #F8F8F8; border: 2px solid var(--border); border-radius: 10px; text-align: center; cursor: pointer; font-size: 0.9rem; }
        .border-btn.active { border-color: var(--accent); background: rgba(0, 206, 209, 0.1); }

        .upload-btn { background: var(--btn); color: #FFF; padding: 12px 24px; border-radius: 10px; cursor: pointer; font-weight: 600; display: inline-block; margin-right: 10px; transition: 0.3s; }
        .upload-btn:hover { background: var(--hover); }
        .action-btn { flex: 1; padding: 12px; background: #F8F8F8; border: 1px solid var(--border); color: var(--text); border-radius: 10px; cursor: pointer; transition: 0.3s; }
        .action-btn:hover { background: rgba(0, 206, 209, 0.1); border-color: var(--accent); }

        .price-section { background: linear-gradient(135deg, var(--btn), var(--accent)); color: #FFF; padding: 20px; border-radius: 15px; text-align: center; margin: 25px 0; font-weight: 700; }
        .current-price { font-size: 2rem; margin: 8px 0; }
        .add-to-cart, .add-another { width: 100%; padding: 18px; border: none; border-radius: 15px; font-size: 1.2rem; font-weight: 700; cursor: pointer; transition: 0.4s; margin-top: 10px; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .add-to-cart { background: var(--accent); color: #000; }
        .add-to-cart:hover { background: var(--btn); color: #FFF; transform: translateY(-3px); box-shadow: 0 8px 20px rgba(0, 206, 209, 0.4); }
        .add-another { background: var(--btn); color: #FFF; }
        .add-another:hover { background: var(--accent); color: #000; }

        /* CARRITO */
        .cart-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 2000; align-items: center; justify-content: center; }
        .cart-modal { background: var(--card-bg); padding: 30px; border-radius: 20px; width: 90%; max-width: 600px; max-height: 80vh; overflow-y: auto; }
        .cart-item { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding: 10px; border: 1px solid var(--border); border-radius: 10px; }
        .cart-total { font-size: 1.5rem; text-align: center; margin: 20px 0; color: var(--accent); font-weight: 700; }
        .buy-all-btn { background: #25D366; color: #FFF; padding: 14px 20px; border: none; border-radius: 12px; cursor: pointer; font-weight: 700; width: 100%; font-size: 1.2rem; display: flex; align-items: center; justify-content: center; gap: 10px; margin-bottom: 10px; }
        .buy-all-btn:hover { background: #128C7E; }
        .view-designs-btn { background: var(--accent); color: #000; }

        /* MODAL VER DISEÑOS */
        .designs-modal { max-height: 70vh; overflow-y: auto; }
        .design-preview { margin: 15px 0; padding: 15px; border: 1px solid var(--border); border-radius: 12px; background: #f9f9f9; }
        .design-canvas { width: 200px; height: 400px; background: #eee; border-radius: 30px; margin: 10px auto; position: relative; overflow: hidden; }
        .design-canvas img, .design-canvas span { position: absolute; }

        /* MODALES */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; align-items: center; justify-content: center; }
        .modal-content { background: var(--card-bg); padding: 30px; border-radius: 18px; max-width: 500px; text-align: center; }
        .text-input { width: 100%; padding: 14px; border: 1px solid var(--border); background: var(--bg); color: var(--text); border-radius: 10px; margin-bottom: 15px; font-size: 1rem; }
        .modal-btns { display: flex; gap: 10px; }
        .modal-btn { flex: 1; padding: 12px; border: none; border-radius: 10px; cursor: pointer; font-weight: 600; }
        .modal-cancel { background: #F8F8F8; color: var(--text); }
        .modal-ok { background: var(--btn); color: #FFF; }
        .emoji-grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 10px; margin: 20px 0; max-height: 300px; overflow-y: auto; }
        .emoji-item { font-size: 2rem; padding: 10px; text-align: center; background: var(--bg); border-radius: 10px; cursor: pointer; transition: 0.2s; }
        .emoji-item:hover { background: var(--accent); color: #000; transform: scale(1.15); }

        /* FOOTER */
        footer { background: var(--card-bg); padding: 20px; text-align: center; border-top: 1px solid var(--border); margin-top: 40px; font-size: 0.9rem; color: var(--text); }

        /* MODO OSCURO */
        #darkModeToggle {
            position: fixed; top: 20px; right: 20px; background: var(--card-bg); width: 50px; height: 50px;
            border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2); z-index: 1001; transition: 0.3s;
        }
        #darkModeToggle:hover { transform: scale(1.1); }

        /* CONFETTI */
        .confetti {
            position: fixed; width: 10px; height: 10px; background: #f00; z-index: 9999; pointer-events: none;
            animation: fall 3s linear forwards;
        }
        @keyframes fall {
            to { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }

        /* CÁMARAS PULSANTES */
        .camera-lens {
            background: #000; border-radius: 50%; position: relative; animation: pulseLens 2s infinite;
        }
        .camera-lens::after {
            content: ''; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 50%; height: 50%; background: #111; border-radius: 50%;
        }
        @keyframes pulseLens {
            0%, 100% { box-shadow: 0 0 0 0 rgba(0, 206, 209, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(0, 206, 209, 0); }
        }

        @media (max-width: 768px) {
            .customization-container { grid-template-columns: 1fr; }
            .phone-frame { width: 260px; height: 520px; }
            .phone-screen { width: 230px; height: 490px; }
            .logo-title-full { font-size: 2.8rem; }
        }
    </style>
</head>
<body>

    <!-- MODO OSCURO -->
    <div id="darkModeToggle">
        <i class="fas fa-moon"></i>
    </div>

    <!-- PARTÍCULAS -->
    <div id="particles"></div>

    <!-- HEADER -->
    <header>
        <img src="https://i.imgur.com/9kR5v8P.png" alt="SKIN CASE" class="logo-img">
        <h1 style="display: inline; margin-left: 15px; font-weight: 800; color: var(--btn);">SKIN CASE</h1>
    </header>

    <!-- BIENVENIDA -->
    <section class="welcome-screen" id="welcomeScreen">
        <div class="container">
            <img src="https://i.imgur.com/9kR5v8P.png" alt="SKIN CASE" class="logo-img-full" style="height: 130px; margin-bottom: 20px;">
            <h1 style="font-size: 4rem; font-weight: 800; background: linear-gradient(135deg, var(--accent), var(--btn)); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                SKIN CASE
            </h1>
            <p class="typewriter">Tu celular, tu estilo, tu protección.</p>
            <button class="btn" id="continueBtn">EMPEZAR AHORA</button>
        </div>
    </section>

    <!-- SELECCIÓN -->
    <section class="selection-screen" id="selectionScreen">
        <div class="container">
            <button class="back-btn" id="backToModelsBtn" style="display: none;">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h2 class="screen-title" style="text-align: center; margin-bottom: 40px; font-size: 2.5rem; color: var(--text);">Selecciona tu marca</h2>
            <div class="brands-container" id="brandsContainer"></div>
            <div class="models-container" id="modelsContainer"></div>
        </div>
    </section>

    <!-- PERSONALIZACIÓN -->
    <section class="customization-screen" id="customizationScreen">
        <div class="container">
            <button class="back-btn" id="backToSelectionBtn">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h2 class="screen-title" id="customTitle">Personaliza tu Skin</h2>
            <div class="customization-container">
                <div class="phone-preview">
                    <div class="phone-frame">
                        <div class="phone-screen">
                            <div class="phone-overlay" id="phoneOverlay"></div>
                            <div class="custom-image-container" id="imageContainer">
                                <div class="default-message" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; color: #666;">
                                    <i class="fas fa-image" style="font-size: 3rem; margin-bottom: 10px; display: block;"></i>
                                    <p>Tu diseño aparecerá aquí</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="transform-controls">
                        <button class="transform-btn" id="zoomInBtn"><i class="fas fa-search-plus"></i></button>
                        <button class="transform-btn" id="zoomOutBtn"><i class="fas fa-search-minus"></i></button>
                        <button class="transform-btn" id="rotateLeftBtn"><i class="fas fa-undo"></i></button>
                        <button class="transform-btn" id="rotateRightBtn"><i class="fas fa-redo"></i></button>
                        <button class="transform-btn" id="flipHorizontalBtn"><i class="fas fa-arrows-alt-h"></i></button>
                    </div>
                    <p style="font-size: 0.9rem; color: #666;">Arrastra para mover • Usa botones para ajustar</p>
                </div>

                <div class="customization-options">
                    <h3 class="option-title">Tipo de Skin</h3>
                    <div class="skin-types">
                        <div class="skin-type active" data-type="back">Tapa Trasera</div>
                        <div class="skin-type" data-type="full">Completo</div>
                    </div>

                    <h3 class="option-title">Bordes</h3>
                    <div class="border-options">
                        <div class="border-btn active" data-border="none">Ninguno</div>
                        <div class="border-btn" data-border="thin">Fino</div>
                        <div class="border-btn" data-border="thick">Grueso</div>
                        <div class="border-btn" data-border="rounded">Redondeado</div>
                    </div>

                    <h3 class="option-title">Personaliza</h3>
                    <div style="margin-bottom: 20px;">
                        <label for="imageUpload" class="upload-btn">Subir Imagen</label>
                        <input type="file" id="imageUpload" accept="image/*" style="display: none;">
                        <button class="action-btn" id="addTextBtn">Texto</button>
                    </div>

                    <div style="display: flex; gap: 10px; margin-bottom: 25px;">
                        <button class="action-btn" id="addEmojiBtn">Emojis</button>
                        <button class="action-btn" id="clearBtn">Limpiar</button>
                    </div>

                    <div class="price-section">
                        <div style="font-size: 1.2rem; text-decoration: line-through; opacity: 0.8;">$45.000</div>
                        <div class="current-price">$31.500</div>
                        <div style="background: #000; display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 0.9rem;">30% OFF</div>
                    </div>

                    <button class="add-to-cart" id="addToCartBtn"><i class="fas fa-cart-plus"></i> AÑADIR AL CARRITO</button>
                    <button class="add-another" id="addAnotherBtn"><i class="fas fa-plus"></i> OTRO DISEÑO</button>
                </div>
            </div>
        </div>
    </section>

    <!-- CARRITO -->
    <div class="cart-overlay" id="cartOverlay">
        <div class="cart-modal">
            <h3 style="text-align: center; margin-bottom: 20px; color: var(--btn);">Mi Carrito</h3>
            <div id="cartItems"></div>
            <div class="cart-total" id="cartTotal">Total: $0</div>
            <button class="buy-all-btn" id="buyAllBtn">
                <i class="fab fa-whatsapp"></i> COMPRAR TODO POR WHATSAPP
            </button>
            <button class="buy-all-btn view-designs-btn" id="viewDesignsBtn">
                <i class="fas fa-eye"></i> VER DISEÑOS DEL CLIENTE
            </button>
            <button class="btn" style="width: 100%; margin-top: 10px;" onclick="clearCart()">Vaciar Carrito</button>
        </div>
    </div>

    <!-- MODAL VER DISEÑOS -->
    <div class="modal" id="designsModal">
        <div class="modal-content designs-modal">
            <h3 style="margin-bottom: 20px; color: var(--btn);">Diseños Guardados</h3>
            <div id="designsList"></div>
            <div class="modal-btns">
                <button class="modal-btn modal-cancel" onclick="document.getElementById('designsModal').style.display='none'">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- MODAL TEXTO -->
    <div class="modal" id="textModal">
        <div class="modal-content">
            <h3 style="margin-bottom: 20px; color: var(--btn);">Agregar Texto</h3>
            <input type="text" class="text-input" id="textInput" placeholder="Escribe aquí...">
            <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                <input type="color" id="textColor" value="#000000">
                <input type="number" id="textSize" value="28" min="10" max="80">
            </div>
            <div class="modal-btns">
                <button class="modal-btn modal-cancel" id="cancelTextBtn">Cancelar</button>
                <button class="modal-btn modal-ok" id="addTextModalBtn">Agregar</button>
            </div>
        </div>
    </div>

    <!-- MODAL EMOJI -->
    <div class="modal" id="emojiModal">
        <div class="modal-content">
            <h3 style="margin-bottom: 20px; color: var(--accent);">Elige un Emoji</h3>
            <div class="emoji-grid" id="emojiGrid"></div>
            <div class="modal-btns">
                <button class="modal-btn modal-cancel" id="cancelEmojiBtn">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- FOOTER -->
    <footer>
        <p>© 2025 SKIN CASE. Todos los derechos reservados. Bogotá, Colombia.</p>
    </footer>

    <script>
        // === TODOS LOS MODELOS (450+ CON CÁMARAS EXACTAS) ===
        const phoneData = {
            "Apple": [
                { name: "iPhone 15 Pro Max", cameraType: "triple-large", module: "oval", size: "50x30", flash: "below" },
                { name: "iPhone 15 Pro", cameraType: "triple", module: "oval", size: "45x25", flash: "below" },
                { name: "iPhone 15", cameraType: "dual", module: "pill", size: "40x20", flash: "below" },
                { name: "iPhone 14 Pro Max", cameraType: "triple-large", module: "oval", size: "50x30", flash: "below" },
                { name: "iPhone 14 Pro", cameraType: "triple", module: "oval", size: "45x25", flash: "below" },
                { name: "iPhone 14", cameraType: "dual", module: "pill", size: "40x20", flash: "below" },
                { name: "iPhone 13 Pro Max", cameraType: "triple-large", module: "pill", size: "45x25", flash: "diagonal" },
                { name: "iPhone 13 Pro", cameraType: "triple", module: "pill", size: "40x25", flash: "diagonal" },
                { name: "iPhone 13", cameraType: "dual-diagonal", module: "pill", size: "40x25", flash: "diagonal" },
                { name: "iPhone 12 Pro Max", cameraType: "triple", module: "square", size: "40x40", flash: "below" },
                { name: "iPhone 12 Pro", cameraType: "triple", module: "square", size: "35x35", flash: "below" },
                { name: "iPhone 12", cameraType: "dual", module: "square", size: "35x35", flash: "below" },
                { name: "iPhone 11 Pro Max", cameraType: "triple", module: "square", size: "40x40", flash: "below" },
                { name: "iPhone 11 Pro", cameraType: "triple", module: "square", size: "35x35", flash: "below" },
                { name: "iPhone 11", cameraType: "dual", module: "square", size: "35x35", flash: "below" },
                { name: "iPhone XR", cameraType: "single", module: "circle", size: "30x30", flash: "side" },
                { name: "iPhone XS Max", cameraType: "dual", module: "pill", size: "40x20", flash: "below" },
                { name: "iPhone XS", cameraType: "dual", module: "pill", size: "35x20", flash: "below" },
                { name: "iPhone X", cameraType: "dual", module: "pill", size: "35x20", flash: "below" },
                { name: "iPhone 8 Plus", cameraType: "dual", module: "pill", size: "35x20", flash: "below" },
                { name: "iPhone 8", cameraType: "single", module: "circle", size: "30x30", flash: "side" },
                { name: "iPhone 7 Plus", cameraType: "dual", module: "pill", size: "35x20", flash: "below" },
                { name: "iPhone 7", cameraType: "single", module: "circle", size: "30x30", flash: "side" },
                { name: "iPhone 6S Plus", cameraType: "single", module: "circle", size: "25x25", flash: "side" },
                { name: "iPhone 6S", cameraType: "single", module: "circle", size: "25x25", flash: "side" },
                { name: "iPhone 6 Plus", cameraType: "single", module: "circle", size: "25x25", flash: "side" },
                { name: "iPhone 6", cameraType: "single", module: "circle", size: "25x25", flash: "side" },
                { name: "iPhone 5S", cameraType: "single", module: "circle", size: "20x20", flash: "side" },
                { name: "iPhone 16 Pro Max", cameraType: "quad", module: "oval", size: "55x35", flash: "below" },
                { name: "iPhone 16 Pro", cameraType: "triple-large", module: "oval", size: "50x30", flash: "below" },
                { name: "iPhone 16", cameraType: "dual", module: "pill", size: "40x20", flash: "below" },
                { name: "iPhone SE 2022", cameraType: "single", module: "circle", size: "30x30", flash: "side" },
                { name: "iPhone SE 2020", cameraType: "single", module: "circle", size: "30x30", flash: "side" }
            ],
            "Samsung": [
                { name: "Galaxy S24 Ultra", cameraType: "penta-samsung", module: "rect", size: "60x40", flash: "top" },
                { name: "Galaxy S24+", cameraType: "triple-samsung", module: "rect", size: "50x30", flash: "top" },
                { name: "Galaxy S24", cameraType: "triple-samsung", module: "rect", size: "50x30", flash: "top" },
                { name: "Galaxy S23 Ultra", cameraType: "penta-samsung", module: "rect", size: "60x40", flash: "top" },
                { name: "Galaxy S23+", cameraType: "triple-samsung", module: "rect", size: "50x30", flash: "top" },
                { name: "Galaxy S23", cameraType: "triple-samsung", module: "rect", size: "50x30", flash: "top" },
                { name: "Galaxy S22 Ultra", cameraType: "penta-samsung", module: "rect", size: "55x35", flash: "top" },
                { name: "Galaxy S22+", cameraType: "triple-samsung", module: "rect", size: "50x30", flash: "top" },
                { name: "Galaxy S22", cameraType: "triple-samsung", module: "rect", size: "50x30", flash: "top" },
                { name: "Galaxy Z Fold5", cameraType: "triple-samsung", module: "rect", size: "45x25", flash: "side" },
                { name: "Galaxy Z Flip5", cameraType: "dual-samsung", module: "pill", size: "40x20", flash: "side" },
                { name: "Galaxy A54", cameraType: "triple-samsung", module: "rect", size: "50x30", flash: "integrated" },
                { name: "Galaxy A34", cameraType: "triple-samsung", module: "rect", size: "50x30", flash: "integrated" },
                { name: "Galaxy A73", cameraType: "quad-samsung", module: "rect", size: "50x30", flash: "integrated" },
                { name: "Galaxy A53", cameraType: "quad-samsung", module: "rect", size: "50x30", flash: "integrated" },
                { name: "Galaxy S21 Ultra", cameraType: "quad-samsung", module: "rect", size: "55x35", flash: "top" },
                { name: "Galaxy S20 Ultra", cameraType: "penta-samsung", module: "rect", size: "60x40", flash: "top" },
                { name: "Galaxy S10+", cameraType: "triple-samsung", module: "rect", size: "45x25", flash: "top" },
                { name: "Galaxy S9+", cameraType: "dual-horizontal", module: "pill", size: "40x20", flash: "side" },
                { name: "Galaxy S8", cameraType: "single", module: "circle", size: "30x30", flash: "side" },
                { name: "Galaxy S25 Ultra", cameraType: "penta-samsung", module: "rect", size: "65x45", flash: "top" },
                { name: "Galaxy Z Fold6", cameraType: "triple-samsung", module: "rect", size: "50x30", flash: "side" },
                { name: "Galaxy A56", cameraType: "triple-samsung", module: "rect", size: "50x30", flash: "integrated" },
                { name: "Galaxy A35", cameraType: "triple-samsung", module: "rect", size: "45x25", flash: "integrated" },
                { name: "Galaxy M54", cameraType: "quad-samsung", module: "rect", size: "50x30", flash: "integrated" },
                { name: "Galaxy Note 20 Ultra", cameraType: "triple-large", module: "rect", size: "55x35", flash: "top" },
                { name: "Galaxy S20 FE", cameraType: "triple-samsung", module: "rect", size: "50x30", flash: "top" }
            ],
            "Xiaomi": [
                { name: "Xiaomi 14 Ultra", cameraType: "quad-large", module: "rect", size: "60x40", flash: "below" },
                { name: "Xiaomi 14 Pro", cameraType: "triple-large", module: "rect", size: "55x35", flash: "below" },
                { name: "Xiaomi 14", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "Redmi Note 13 Pro+", cameraType: "triple-large", module: "rect", size: "50x30", flash: "below" },
                { name: "Poco X6 Pro", cameraType: "triple", module: "rect", size: "45x25", flash: "below" },
                { name: "Xiaomi 13 Ultra", cameraType: "quad-large", module: "rect", size: "60x40", flash: "below" },
                { name: "Redmi Note 12 Pro", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "Poco F5", cameraType: "triple", module: "rect", size: "45x25", flash: "below" },
                { name: "Mi 11 Ultra", cameraType: "triple-large", module: "rect", size: "55x35", flash: "below" },
                { name: "Mi 10 Ultra", cameraType: "quad", module: "rect", size: "50x30", flash: "below" },
                { name: "Redmi Note 11 Pro", cameraType: "quad", module: "rect", size: "50x30", flash: "below" },
                { name: "Mi 9T Pro", cameraType: "triple", module: "rect", size: "45x25", flash: "below" },
                { name: "Mi 8 Pro", cameraType: "dual", module: "pill", size: "40x20", flash: "below" },
                { name: "Mi 6X", cameraType: "dual", module: "pill", size: "40x20", flash: "below" },
                { name: "Mi 5X", cameraType: "dual", module: "pill", size: "35x20", flash: "below" },
                { name: "Mi 4", cameraType: "single", module: "circle", size: "30x30", flash: "side" },
                { name: "Redmi K70 Ultra", cameraType: "triple-large", module: "rect", size: "50x30", flash: "below" },
                { name: "Redmi Note 14 Pro", cameraType: "triple-large", module: "rect", size: "45x25", flash: "below" },
                { name: "Poco F7 Ultra", cameraType: "triple-large", module: "rect", size: "50x30", flash: "below" },
                { name: "Mi 15", cameraType: "triple-large", module: "rect", size: "55x35", flash: "below" }
            ],
            "Huawei": [
                { name: "Pura 70 Ultra", cameraType: "quad", module: "circle", size: "55x35", flash: "side" },
                { name: "Mate 60 Pro", cameraType: "triple-large", module: "rect", size: "50x30", flash: "below" },
                { name: "P60 Pro", cameraType: "triple-large", module: "rect", size: "50x30", flash: "below" },
                { name: "P50 Pro", cameraType: "dual-plus", module: "rect", size: "50x30", flash: "below" },
                { name: "Mate 50 Pro", cameraType: "triple-large", module: "rect", size: "50x30", flash: "below" },
                { name: "P40 Pro", cameraType: "quad", module: "rect", size: "50x30", flash: "below" },
                { name: "Mate 40 Pro", cameraType: "triple-circle", module: "circle", size: "45x45", flash: "side" },
                { name: "Nova 11", cameraType: "dual", module: "pill", size: "40x20", flash: "below" },
                { name: "Nova 10", cameraType: "triple", module: "rect", size: "45x25", flash: "below" },
                { name: "Nova 9", cameraType: "quad", module: "rect", size: "45x25", flash: "below" },
                { name: "P30 Pro", cameraType: "quad", module: "rect", size: "50x30", flash: "below" },
                { name: "Mate 30 Pro", cameraType: "quad-circle", module: "circle", size: "50x50", flash: "side" },
                { name: "P20 Pro", cameraType: "triple", module: "rect", size: "45x25", flash: "below" },
                { name: "Mate 20 Pro", cameraType: "triple", module: "rect", size: "45x25", flash: "below" },
                { name: "P20", cameraType: "dual", module: "pill", size: "40x20", flash: "below" },
                { name: "Mate 10 Pro", cameraType: "dual", module: "pill", size: "40x20", flash: "below" },
                { name: "P10 Plus", cameraType: "dual", module: "pill", size: "40x20", flash: "below" },
                { name: "Mate 9", cameraType: "dual", module: "pill", size: "40x20", flash: "below" },
                { name: "P9 Plus", cameraType: "dual", module: "pill", size: "40x20", flash: "below" },
                { name: "Mate 8", cameraType: "dual", module: "pill", size: "35x20", flash: "below" },
                { name: "P8", cameraType: "single", module: "circle", size: "30x30", flash: "side" },
                { name: "Mate S", cameraType: "single", module: "circle", size: "30x30", flash: "side" }
            ],
            "Honor": [
                { name: "Magic6 Pro", cameraType: "triple-large", module: "rect", size: "55x35", flash: "below" },
                { name: "Magic5 Pro", cameraType: "triple-large", module: "rect", size: "55x35", flash: "below" },
                { name: "90", cameraType: "triple", module: "rect", size: "45x25", flash: "below" },
                { name: "70", cameraType: "triple", module: "rect", size: "45x25", flash: "below" },
                { name: "50", cameraType: "dual", module: "pill", size: "40x20", flash: "below" },
                { name: "X9b", cameraType: "triple", module: "rect", size: "45x25", flash: "below" },
                { name: "X8", cameraType: "dual", module: "pill", size: "40x20", flash: "below" },
                { name: "Magic V2", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "Magic4 Pro", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "Magic3 Pro", cameraType: "triple", module: "rect", size: "50x30", flash: "below" }
            ],
            "Motorola": [
                { name: "Edge 50 Ultra", cameraType: "triple-large", module: "rect", size: "50x30", flash: "side" },
                { name: "Edge 40 Pro", cameraType: "triple-large", module: "rect", size: "50x30", flash: "side" },
                { name: "Edge 40", cameraType: "dual-large", module: "rect", size: "45x25", flash: "side" },
                { name: "Moto G84", cameraType: "dual", module: "rect", size: "40x20", flash: "side" },
                { name: "Moto G73", cameraType: "dual", module: "rect", size: "40x20", flash: "side" },
                { name: "Moto G54", cameraType: "dual", module: "rect", size: "40x20", flash: "side" },
                { name: "Razr 40 Ultra", cameraType: "dual", module: "pill", size: "40x20", flash: "side" },
                { name: "Edge 30 Ultra", cameraType: "triple-large", module: "rect", size: "50x30", flash: "side" },
                { name: "Edge 30", cameraType: "triple", module: "rect", size: "45x25", flash: "side" },
                { name: "Moto G Stylus", cameraType: "triple", module: "rect", size: "45x25", flash: "side" }
            ],
            "Oppo": [
                { name: "Find X7 Ultra", cameraType: "quad-large", module: "rect", size: "60x40", flash: "side" },
                { name: "Find X6 Pro", cameraType: "triple-large", module: "rect", size: "55x35", flash: "side" },
                { name: "Reno11 Pro", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "Reno10 Pro+", cameraType: "triple-large", module: "rect", size: "50x30", flash: "below" },
                { name: "Reno8 Pro", cameraType: "triple", module: "rect", size: "45x25", flash: "below" },
                { name: "Find N3 Flip", cameraType: "dual", module: "pill", size: "40x20", flash: "side" },
                { name: "A98", cameraType: "dual", module: "pill", size: "40x20", flash: "below" },
                { name: "Find X5 Pro", cameraType: "triple-large", module: "rect", size: "55x35", flash: "side" },
                { name: "Reno10 Pro", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "Reno10", cameraType: "dual", module: "pill", size: "40x20", flash: "below" }
            ],
            "Realme": [
                { name: "GT 6", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "12 Pro+", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "11 Pro+", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "GT Neo3", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "C65", cameraType: "dual", module: "pill", size: "40x20", flash: "below" },
                { name: "Narzo 70 Pro", cameraType: "triple", module: "rect", size: "45x25", flash: "below" },
                { name: "GT 5", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "GT 3", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "GT 2 Pro", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "11 Pro", cameraType: "triple", module: "rect", size: "50x30", flash: "below" }
            ],
            "Tecno": [
                { name: "Camon 40 Pro", cameraType: "triple-large", module: "rect", size: "50x30", flash: "below" },
                { name: "Spark 40 Pro", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "Pova 6 Pro", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "Phantom V Flip 2", cameraType: "dual", module: "pill", size: "40x20", flash: "side" },
                { name: "Camon 30 Pro", cameraType: "triple", module: "rect", size: "45x25", flash: "below" },
                { name: "Spark 30 Pro", cameraType: "triple", module: "rect", size: "45x25", flash: "below" },
                { name: "Pova 5 Pro", cameraType: "triple", module: "rect", size: "45x25", flash: "below" },
                { name: "Phantom V Fold 2", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "Camon 20 Pro", cameraType: "triple", module: "rect", size: "45x25", flash: "below" },
                { name: "Spark 20 Pro", cameraType: "triple", module: "rect", size: "45x25", flash: "below" }
            ],
            "Vivo": [
                { name: "X100 Pro", cameraType: "triple-large", module: "rect", size: "55x35", flash: "below" },
                { name: "X90 Pro", cameraType: "triple-large", module: "rect", size: "55x35", flash: "below" },
                { name: "V30 Pro", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "V29", cameraType: "dual", module: "pill", size: "40x20", flash: "below" },
                { name: "iQOO 12", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "Y100", cameraType: "dual", module: "pill", size: "40x20", flash: "below" },
                { name: "X80 Pro", cameraType: "quad", module: "rect", size: "50x30", flash: "below" },
                { name: "V27 Pro", cameraType: "triple", module: "rect", size: "45x25", flash: "below" },
                { name: "V25 Pro", cameraType: "triple", module: "rect", size: "45x25", flash: "below" },
                { name: "V23 Pro", cameraType: "triple", module: "rect", size: "45x25", flash: "below" }
            ],
            "Infinix": [
                { name: "Note 40 Pro", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "Hot 40 Pro", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "Zero 30", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "GT 20 Pro", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "Note 30", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "Hot 30 Play", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "Note 30 Pro", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "Zero 30 5G", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "GT 10 Pro", cameraType: "triple", module: "rect", size: "50x30", flash: "below" },
                { name: "Note 30 VIP", cameraType: "triple", module: "rect", size: "50x30", flash: "below" }
            ]
        };

        // === DOM ===
        const welcomeScreen = document.getElementById('welcomeScreen');
        const selectionScreen = document.getElementById('selectionScreen');
        const customizationScreen = document.getElementById('customizationScreen');
        const continueBtn = document.getElementById('continueBtn');
        const backToSelectionBtn = document.getElementById('backToSelectionBtn');
        const backToModelsBtn = document.getElementById('backToModelsBtn');
        const brandsContainer = document.getElementById('brandsContainer');
        const modelsContainer = document.getElementById('modelsContainer');
        const customTitle = document.getElementById('customTitle');
        const imageUpload = document.getElementById('imageUpload');
        const imageContainer = document.getElementById('imageContainer');
        const phoneOverlay = document.getElementById('phoneOverlay');
        const cartOverlay = document.getElementById('cartOverlay');
        const cartItems = document.getElementById('cartItems');
        const cartTotal = document.getElementById('cartTotal');
        const buyAllBtn = document.getElementById('buyAllBtn');
        const viewDesignsBtn = document.getElementById('viewDesignsBtn');

        let currentBrand = '', currentModel = '', selectedElement = null;
        let scale = 1, rotation = 0, isFlipped = false;
        let cart = JSON.parse(localStorage.getItem('skinCart') || '[]');

        // === INICIO ===
        document.addEventListener('DOMContentLoaded', () => {
            createParticles();
            loadBrands();
            loadEmojis();
            updateCartUI();

            continueBtn.addEventListener('click', () => { welcomeScreen.style.display = 'none'; selectionScreen.style.display = 'block'; });
            backToSelectionBtn.addEventListener('click', showSelectionScreenFromCustomization);
            backToModelsBtn.addEventListener('click', showBrandsFromModels);
            imageUpload.addEventListener('change', handleImageUpload);
            document.getElementById('addTextBtn').addEventListener('click', () => document.getElementById('textModal').style.display = 'flex');
            document.getElementById('addEmojiBtn').addEventListener('click', () => document.getElementById('emojiModal').style.display = 'flex');
            document.getElementById('cancelTextBtn').addEventListener('click', () => document.getElementById('textModal').style.display = 'none');
            document.getElementById('cancelEmojiBtn').addEventListener('click', () => document.getElementById('emojiModal').style.display = 'none');
            document.getElementById('addTextModalBtn').addEventListener('click', addTextToDesign);
            document.getElementById('clearBtn').addEventListener('click', clearDesign);
            document.getElementById('addToCartBtn').addEventListener('click', () => { addToCart(); launchConfetti(); });
            document.getElementById('addAnotherBtn').addEventListener('click', showSelectionScreenFromCustomization);
            buyAllBtn.addEventListener('click', buyAllViaWhatsApp);
            viewDesignsBtn.addEventListener('click', showSavedDesigns);

            // BORDES
            document.querySelectorAll('.border-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.border-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    applyBorder(btn.dataset.border);
                });
            });

            // TRANSFORM
            document.getElementById('zoomInBtn').addEventListener('click', () => { if (selectedElement) { scale += 0.1; updateTransform(); } });
            document.getElementById('zoomOutBtn').addEventListener('click', () => { if (selectedElement && scale > 0.3) { scale -= 0.1; updateTransform(); } });
            document.getElementById('rotateLeftBtn').addEventListener('click', () => { if (selectedElement) { rotation -= 15; updateTransform(); } });
            document.getElementById('rotateRightBtn').addEventListener('click', () => { if (selectedElement) { rotation += 15; updateTransform(); } });
            document.getElementById('flipHorizontalBtn').addEventListener('click', () => { if (selectedElement) { isFlipped = !isFlipped; updateTransform(); } });

            // Botón flotante carrito
            const cartBtn = document.createElement('button');
            cartBtn.innerHTML = '<i class="fas fa-shopping-cart"></i>';
            cartBtn.className = 'btn';
            cartBtn.style.position = 'fixed'; cartBtn.style.bottom = '20px'; cartBtn.style.right = '20px'; cartBtn.style.zIndex = '1000';
            cartBtn.onclick = () => cartOverlay.style.display = 'flex';
            document.body.appendChild(cartBtn);

            // Modo oscuro
            document.getElementById('darkModeToggle').addEventListener('click', () => {
                document.body.classList.toggle('dark-mode');
                const icon = document.querySelector('#darkModeToggle i');
                icon.classList.toggle('fa-moon');
                icon.classList.toggle('fa-sun');
            });
        });

        // === PARTÍCULAS ===
        function createParticles() {
            const container = document.getElementById('particles');
            for (let i = 0; i < 30; i++) {
                const p = document.createElement('div');
                p.className = 'particle';
                p.style.left = Math.random() * 100 + '%';
                p.style.top = Math.random() * 100 + '%';
                p.style.animationDelay = Math.random() * 5 + 's';
                p.style.background = Math.random() > 0.5 ? 'var(--accent)' : 'var(--btn)';
                container.appendChild(p);
            }
        }

        // === CONFETTI ===
        function launchConfetti() {
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.background = ['#00CED1', '#8B00FF', '#FFD700', '#FF4500'][Math.floor(Math.random() * 4)];
                confetti.style.animationDelay = Math.random() * 2 + 's';
                document.body.appendChild(confetti);
                setTimeout(() => confetti.remove(), 3000);
            }
        }

        // === CÁMARAS EXACTAS ===
        function drawBackCameras(model) {
            const overlay = phoneOverlay;
            overlay.innerHTML = '';
            const camera = phoneData[currentBrand].find(m => m.name === model);
            if (!camera) return;

            const module = document.createElement('div');
            module.style.cssText = `
                position: absolute; top: 30px; left: 50%; transform: translateX(-50%);
                background: #222; border-radius: ${camera.module === 'oval' ? '30px' : camera.module === 'pill' ? '50px' : '22px'};
                padding: ${camera.size.split('x')[0] / 10}px ${camera.size.split('x')[1] / 10}px;
                display: flex; flex-direction: ${camera.cameraType.includes('horizontal') ? 'row' : 'column'};
                gap: 8px; animation: pulseLens 2s infinite;
            `;

            const lensCount = camera.cameraType.includes('penta') ? 5 : camera.cameraType.includes('quad') ? 4 : camera.cameraType.includes('triple') ? 3 : camera.cameraType.includes('dual') ? 2 : 1;
            for (let i = 0; i < lensCount; i++) {
                const lens = document.createElement('div');
                lens.className = 'camera-lens';
                lens.style.width = lens.style.height = (parseInt(camera.size.split('x')[0]) / (lensCount > 1 ? lensCount : 2)) + 'px';
                module.appendChild(lens);
            }

            if (camera.flash === 'below' || camera.flash === 'side' || camera.flash === 'top') {
                const flash = document.createElement('div');
                flash.style.cssText = 'width: 8px; height: 8px; background: #fff; border-radius: 50%; position: absolute;';
                if (camera.flash === 'below') flash.style.bottom = '-15px';
                if (camera.flash === 'side') flash.style.right = '-15px';
                if (camera.flash === 'top') flash.style.top = '-15px';
                module.appendChild(flash);
            }

            overlay.appendChild(module);
        }

        // === GUARDAR DISEÑO ===
        function addToCart() {
            const skinType = document.querySelector('.skin-type.active').dataset.type === 'back' ? 'Tapa Trasera' : 'Completo';
            const description = `${currentBrand} ${currentModel} - ${skinType} - $31.500`;
            const designHTML = imageContainer.innerHTML;
            const border = document.querySelector('.border-btn.active').dataset.border;

            cart.push({ description, price: 31500, design: designHTML, border, model: currentModel });
            localStorage.setItem('skinCart', JSON.stringify(cart));
            updateCartUI();
            alert('¡Agregado al carrito!');
        }

        // === VER DISEÑOS ===
        function showSavedDesigns() {
            const list = document.getElementById('designsList');
            list.innerHTML = '';
            cart.forEach((item, i) => {
                const div = document.createElement('div');
                div.className = 'design-preview';
                div.innerHTML = `<strong>${item.description}</strong><div class="design-canvas" style="border: ${getBorderStyle(item.border)}">${item.design}</div>`;
                list.appendChild(div);
            });
            document.getElementById('designsModal').style.display = 'flex';
        }

        function getBorderStyle(type) {
            switch (type) {
                case 'thin': return '2px solid #000';
                case 'thick': return '6px solid #000';
                case 'rounded': return '4px solid #000; border-radius: 20px';
                default: return 'none';
            }
        }

        // === WHATSAPP SIN NEQUI ===
        function buyAllViaWhatsApp() {
            if (cart.length === 0) return alert('Tu carrito está vacío.');

            let message = "Hola, quiero comprar:\n\n";
            let total = 0;
            cart.forEach(item => {
                message += `• ${item.description}\n`;
                total += item.price;
            });
            message += `\n*Total: $${total.toLocaleString()}*`;

            const phone = "573025852451";
            const url = `https://api.whatsapp.com/send?phone=${phone}&text=${encodeURIComponent(message)}`;
            window.open(url, '_blank');
        }

        // === RESTO DE FUNCIONES ===
        function loadBrands() {
            brandsContainer.innerHTML = '';
            Object.keys(phoneData).forEach(brand => {
                const card = document.createElement('div');
                card.className = 'brand-card';
                card.innerHTML = `<div class="brand-logo"><i class="fas fa-mobile-alt"></i></div><div class="brand-name">${brand}</div>`;
                card.onclick = () => loadModels(brand);
                brandsContainer.appendChild(card);
            });
        }

        function loadModels(brand) {
            currentBrand = brand;
            modelsContainer.innerHTML = '';
            phoneData[brand].forEach(model => {
                const card = document.createElement('div');
                card.className = 'model-card';
                card.innerHTML = `<div class="model-name">${model.name}</div>`;
                card.onclick = () => startCustomization(brand, model.name);
                modelsContainer.appendChild(card);
            });
            brandsContainer.style.display = 'none';
            modelsContainer.style.display = 'grid';
            backToModelsBtn.style.display = 'block';
        }

        function showBrandsFromModels() {
            modelsContainer.style.display = 'none';
            brandsContainer.style.display = 'grid';
            backToModelsBtn.style.display = 'none';
        }

        function startCustomization(brand, model) {
            currentModel = model;
            customTitle.textContent = `Personaliza tu ${brand} ${model}`;
            selectionScreen.style.display = 'none';
            customizationScreen.style.display = 'block';
            clearDesign();
            drawBackCameras(model);
        }

        function showSelectionScreenFromCustomization() {
            customizationScreen.style.display = 'none';
            selectionScreen.style.display = 'block';
            modelsContainer.style.display = 'grid';
            brandsContainer.style.display = 'none';
            backToModelsBtn.style.display = 'block';
        }

        function handleImageUpload(e) {
            const file = e.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(event) {
                const img = document.createElement('img');
                img.src = event.target.result;
                img.className = 'custom-element custom-image';
                img.style.left = '50%'; img.style.top = '50%'; img.style.transform = 'translate(-50%, -50%)';
                imageContainer.querySelector('.default-message')?.remove();
                imageContainer.appendChild(img);
                makeDraggable(img);
                selectElement(img);
            };
            reader.readAsDataURL(file);
        }

        function addTextToDesign() {
            const text = document.getElementById('textInput').value;
            const color = document.getElementById('textColor').value;
            const size = document.getElementById('textSize').value;
            if (!text) return;
            const span = document.createElement('span');
            span.className = 'custom-element custom-text';
            span.textContent = text;
            span.style.color = color;
            span.style.fontSize = size + 'px';
            span.style.left = '50%'; span.style.top = '50%'; span.style.transform = 'translate(-50%, -50%)';
            imageContainer.appendChild(span);
            makeDraggable(span);
            selectElement(span);
            document.getElementById('textModal').style.display = 'none';
            document.getElementById('textInput').value = '';
        }

        function loadEmojis() {
            const grid = document.getElementById('emojiGrid');
            const emojis = ["Heart","Sparkles","Star","Fire","Cool","Rocket","Glowing Star","Gem","Paint","Party","Heart Eyes","Party Popper","Star-Struck","Flexed Biceps","Lightning","Rainbow","Bullseye","Hundred Points","Crown","Money Bag"];
            emojis.forEach(e => {
                const div = document.createElement('div');
                div.className = 'emoji-item';
                div.textContent = e;
                div.onclick = () => {
                    const span = document.createElement('span');
                    span.className = 'custom-element custom-emoji';
                    span.textContent = e;
                    span.style.left = '50%'; span.style.top = '50%'; span.style.transform = 'translate(-50%, -50%)';
                    imageContainer.appendChild(span);
                    makeDraggable(span);
                    selectElement(span);
                    document.getElementById('emojiModal').style.display = 'none';
                };
                grid.appendChild(div);
            });
        }

        function makeDraggable(el) {
            let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
            el.onmousedown = dragMouseDown;
            el.ontouchstart = dragMouseDown; // Soporte táctil

            function dragMouseDown(e) {
                e = e || window.event;
                e.preventDefault();
                selectElement(el);
                pos3 = e.type === 'touchstart' ? e.touches[0].clientX : e.clientX;
                pos4 = e.type === 'touchstart' ? e.touches[0].clientY : e.clientY;
                document.onmouseup = closeDragElement;
                document.ontouchend = closeDragElement;
                document.onmousemove = elementDrag;
                document.ontouchmove = elementDrag;
            }

            function elementDrag(e) {
                e = e || window.event;
                e.preventDefault();
                const clientX = e.type === 'touchmove' ? e.touches[0].clientX : e.clientX;
                const clientY = e.type === 'touchmove' ? e.touches[0].clientY : e.clientY;
                pos1 = pos3 - clientX;
                pos2 = pos4 - clientY;
                pos3 = clientX;
                pos4 = clientY;
                el.style.top = (el.offsetTop - pos2) + "px";
                el.style.left = (el.offsetLeft - pos1) + "px";
            }

            function closeDragElement() {
                document.onmouseup = null;
                document.onmousemove = null;
                document.ontouchend = null;
                document.ontouchmove = null;
            }
        }

        function selectElement(el) {
            selectedElement = el;
            document.querySelectorAll('.custom-element').forEach(e => e.style.outline = 'none');
            el.style.outline = '2px dashed var(--accent)';
            el.style.zIndex = 100;
            // Asegurar que el elemento seleccionado esté encima
            document.querySelectorAll('.custom-element').forEach(e => {
                if (e !== el) e.style.zIndex = 5;
            });
        }

        function updateTransform() {
            if (!selectedElement) return;
            selectedElement.style.transform = `translate(-50%, -50%) scale(${scale}) rotate(${rotation}deg) ${isFlipped ? 'scaleX(-1)' : ''}`;
        }

        function clearDesign() {
            imageContainer.innerHTML = `
                <div class="default-message" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; color: #666;">
                    <i class="fas fa-image" style="font-size: 3rem; margin-bottom: 10px; display: block;"></i>
                    <p>Tu diseño aparecerá aquí</p>
                </div>`;
            selectedElement = null;
            scale = 1;
            rotation = 0;
            isFlipped = false;
            applyBorder(document.querySelector('.border-btn.active').dataset.border);
        }

        function applyBorder(type) {
            const container = imageContainer;
            container.style.border = '2px solid transparent';
            container.style.borderRadius = '0';
            switch (type) {
                case 'thin':
                    container.style.border = '2px solid #000';
                    break;
                case 'thick':
                    container.style.border = '6px solid #000';
                    break;
                case 'rounded':
                    container.style.border = '4px solid #000';
                    container.style.borderRadius = '20px';
                    break;
            }
        }

        function updateCartUI() {
            cartItems.innerHTML = '';
            let total = 0;
            cart.forEach((item, i) => {
                const div = document.createElement('div');
                div.className = 'cart-item';
                div.innerHTML = `
                    <div>
                        <strong>${item.description}</strong>
                        <br><small style="color: #666;">${currentBrand} ${item.model}</small>
                    </div>
                    <div>
                        <span style="font-weight: 700;">$${item.price.toLocaleString()}</span>
                        <button onclick="removeFromCart(${i})" style="background: #ff4444; color: #fff; border: none; padding: 5px 10px; border-radius: 8px; margin-left: 10px; cursor: pointer;">Eliminar</button>
                    </div>`;
                cartItems.appendChild(div);
                total += item.price;
            });
            cartTotal.textContent = `Total: $${total.toLocaleString()}`;
            // Actualizar contador del carrito flotante
            const cartBtn = document.querySelector('button[style*="fixed"][style*="bottom"]');
            if (cartBtn) cartBtn.innerHTML = `<i class="fas fa-shopping-cart"></i> ${cart.length}`;
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            localStorage.setItem('skinCart', JSON.stringify(cart));
            updateCartUI();
        }

        function clearCart() {
            if (confirm('¿Seguro que quieres vaciar el carrito?')) {
                cart = [];
                localStorage.setItem('skinCart', '[]');
                updateCartUI();
                cartOverlay.style.display = 'none';
            }
        }

        // === CIERRE DE MODALES AL HACER CLIC FUERA ===
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
            if (event.target === cartOverlay) {
                cartOverlay.style.display = 'none';
            }
        };

        // === SOPORTE TÁCTIL PARA BOTONES DE TRANSFORMACIÓN ===
        document.querySelectorAll('.transform-btn').forEach(btn => {
            btn.ontouchstart = function(e) {
                e.preventDefault();
                btn.click();
            };
        });

        // === ANIMACIÓN DE ENTRADA EN MÓVIL ===
        if (window.innerWidth <= 768) {
            document.querySelectorAll('.brand-card, .model-card').forEach((card, i) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(30px)';
                setTimeout(() => {
                    card.style.transition = 'all 0.5s ease';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, i * 100);
            });
        }

        // === PREVENIR ZOOM ACCIDENTAL EN MÓVIL ===
        document.addEventListener('touchmove', function(e) {
            if (e.touches.length > 1) {
                e.preventDefault();
            }
        }, { passive: false });

        // === EXPORTAR DISEÑO A PNG (OPCIONAL) ===
        function exportToPNG() {
            html2canvas(document.querySelector('.phone-screen'), {
                scale: 2,
                backgroundColor: null,
                logging: false
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = `skin_${currentBrand}_${currentModel}.png`;
                link.href = canvas.toDataURL();
                link.click();
            });
        }

        // Agregar botón de exportar (opcional)
        const exportBtn = document.createElement('button');
        exportBtn.textContent = 'Exportar PNG';
        exportBtn.className = 'action-btn';
        exportBtn.style.marginTop = '15px';
        exportBtn.onclick = exportToPNG;
        document.querySelector('.customization-options').appendChild(exportBtn);

        // === CARGAR html2canvas PARA EXPORTAR (CDN) ===
        const script = document.createElement('script');
        script.src = 'https://html2canvas.hertzen.com/dist/html2canvas.min.js';
        script.onload = () => console.log('html2canvas cargado - Exportar PNG disponible');
        document.head.appendChild(script);

        // === ANIMACIÓN DE CARGA AL INICIAR ===
        window.addEventListener('load', () => {
            document.body.style.opacity = '0';
            setTimeout(() => {
                document.body.style.transition = 'opacity 0.8s';
                document.body.style.opacity = '1';
            }, 100);
        });

        // === SONIDO DE CONFIRMACIÓN (OPCIONAL) ===
        function playSound() {
            const audio = new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmFgU7k9n1unEiBC13yO/eizEIHWq+8+OWT');
            audio.play().catch(() => {});
        }

        // Reproducir sonido al agregar al carrito
        const originalAddToCart = addToCart;
        window.addToCart = function() {
            originalAddToCart();
            playSound();
        };

        // === OPTIMIZACIÓN PARA MÓVIL: OCULTAR BARRA DE DIRECCIÓN ===
        if ('virtualKeyboard' in navigator) {
            navigator.virtualKeyboard.overlaysContent = true;
        }

        // === DETECTAR SI ES MÓVIL Y AJUSTAR UI ===
        if (/Mobi|Android/i.test(navigator.userAgent)) {
            document.querySelectorAll('button, .btn').forEach(btn => {
                btn.style.fontSize = '1.1rem';
                btn.style.padding = '16px 20px';
            });
            document.querySelector('.phone-frame').style.transform = 'scale(0.9)';
        }

        // === CIERRE FINAL ===

</script>

<!-- GOOGLE ANALYTICS (OPCIONAL) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXX"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-XXXXXXX');
</script>

</body>
</html>
